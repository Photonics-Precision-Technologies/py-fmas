

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>1.4.2. Nonlinear Schrödinger equation with loss &mdash; py-fmas 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.4.3. NLPM750 fiber model with loss" href="ng_fiber_details_nlpm750.html" />
    <link rel="prev" title="1.4.1. Attenuation of a NLPM750 fiber" href="g_absorption_profile.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> py-fmas
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">1. Extended user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#basic-examples">1.1. Basic examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#more-specific-examples">1.2. More specific examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#photon-number-conservation">1.3. Photon number conservation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#attenuation">1.4. Attenuation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="g_absorption_profile.html">1.4.1. Attenuation of a NLPM750 fiber</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.4.2. Nonlinear Schrödinger equation with loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="ng_fiber_details_nlpm750.html">1.4.3. NLPM750 fiber model with loss</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#performance-tests">1.5. Performance tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">2. Usage examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_manual/index.html">3. Reference manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citations.html">4. Citations</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">py-fmas</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">1. </span>Extended user guide</a> &raquo;</li>
        
      <li><span class="section-number">1.4.2. </span>Nonlinear Schrödinger equation with loss</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/auto_tutorials/attenuation/g_NSE_absorption_constant.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-attenuation-g-nse-absorption-constant-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="nonlinear-schrodinger-equation-with-loss">
<span id="sphx-glr-auto-tutorials-attenuation-g-nse-absorption-constant-py"></span><h1><span class="section-number">1.4.2. </span>Nonlinear Schrödinger equation with loss<a class="headerlink" href="#nonlinear-schrodinger-equation-with-loss" title="Permalink to this headline">¶</a></h1>
<p>This example demonstrates how to perform simulations for the nonlinear
Schrödinger equation including loss.</p>
<p>We first import the functionality needed to perform the sequence of numerical
experiments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">fmas.models</span> <span class="kn">import</span> <span class="n">ModelBaseClass</span>
<span class="kn">from</span> <span class="nn">fmas.config</span> <span class="kn">import</span> <span class="n">FTFREQ</span><span class="p">,</span> <span class="n">FT</span><span class="p">,</span> <span class="n">IFT</span><span class="p">,</span> <span class="n">C0</span>
<span class="kn">from</span> <span class="nn">fmas.grid</span> <span class="kn">import</span> <span class="n">Grid</span>
<span class="kn">from</span> <span class="nn">fmas.solver</span> <span class="kn">import</span> <span class="n">SySSM</span>
</pre></div>
</div>
<p>Next, we implement a model for the nonlinear Schrödinger equation.  In
particular, we here consider the standard nonlinear Schrödinger equation,
given by</p>
<div class="math notranslate nohighlight">
\[\partial_z u = -\alpha u -i \frac{\beta_2}{2}\partial_t^2 u + i\gamma |u|^2 u,\]</div>
<p>wherein <span class="math notranslate nohighlight">\(u = u(z, t)\)</span> represents the slowly varying pulse envelope,
where <span class="math notranslate nohighlight">\(\alpha\)</span> is the root-power attenuation constant accounting for fiber
loss, <span class="math notranslate nohighlight">\(\beta_2=-1\)</span> is the second order dispersion parameter, and
<span class="math notranslate nohighlight">\(\gamma=1\)</span> is the nonlinear parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NSE</span><span class="p">(</span><span class="n">ModelBaseClass</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">beta_w</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">alpha_w</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Lw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_w</span>

    <span class="k">def</span> <span class="nf">N</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uw</span><span class="p">):</span>
        <span class="n">ut</span> <span class="o">=</span> <span class="n">IFT</span><span class="p">(</span><span class="n">uw</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">FT</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ut</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ut</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we set up the computational domain, the model, an instance of a
symmetric split-step Fourier solver and prepare an initial condition given by
a fundamental soliton.</p>
<p>To construct the initial condition, we use the exact single-soliton solution
of the nonlinar Schrödinger equation, given by</p>
<div class="math notranslate nohighlight">
\[u_{\rm{exact}}(z,t) = \sqrt{P_0} {\rm{sech}}(t/t_0)\,e^{-i\gamma P_0 z/2},\]</div>
<p>with <span class="math notranslate nohighlight">\(P_0=|\beta_2|/(\gamma t_0^2)\)</span>. We here consider a fundamental
soliton of duration <span class="math notranslate nohighlight">\(t_0=1\)</span> and use <span class="math notranslate nohighlight">\(u_{\rm{exact}}(0,t)\)</span> as
initial condition.  The propagation is performed up to
<span class="math notranslate nohighlight">\(z_{\rm{max}}=\pi/2\)</span>, i.e.  for one soliton period.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- SET MODEL PARAMETERS</span>
<span class="n">t_max</span> <span class="o">=</span> <span class="o">-</span><span class="mf">50.0</span>
<span class="n">Nt</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">12</span>
<span class="c1"># ... PROPAGATION CONSTANT (POLYNOMIAL MODEL)</span>
<span class="n">b2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
<span class="n">beta</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">w</span> <span class="o">*</span> <span class="n">w</span>
<span class="c1"># ... NONLINEAR PARAMETER</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># ... POWER ATTENUATION PARAMETER</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># ... SOLITON PARAMTERS</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># duration</span>
<span class="n">P0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span> <span class="o">/</span> <span class="n">t0</span> <span class="o">/</span> <span class="n">t0</span> <span class="o">/</span> <span class="n">gamma</span>  <span class="c1"># peak-intensity</span>
<span class="n">LD</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">*</span> <span class="n">t0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>  <span class="c1"># dispersion length</span>
<span class="c1"># ... EXACT SOLUTION</span>
<span class="n">u_exact</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">P0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="n">j</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">P0</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">t0</span><span class="p">)</span>
</pre></div>
</div>
<p>We here measure the effect of fiber loss by monitoring the energy</p>
<div class="math notranslate nohighlight">
\[E(z) = \sum_w |u_\omega(z)|^2\]</div>
<p>which is expected to decay as</p>
<div class="math notranslate nohighlight">
\[E(z) = E(0)\,e^{-2 \alpha z}\]</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Ce</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">uw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">uw</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>


<span class="c1"># -- INITIALIZATION STAGE</span>
<span class="c1"># ... COMPUTATIONAL DOMAIN</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span><span class="n">t_max</span><span class="o">=</span><span class="n">t_max</span><span class="p">,</span> <span class="n">t_num</span><span class="o">=</span><span class="n">Nt</span><span class="p">)</span>
<span class="n">t</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">w</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">NSE</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">beta</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<span class="c1"># ... PROPAGATION ALGORITHM</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">SySSM</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Lw</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">user_action</span><span class="o">=</span><span class="n">Ce</span><span class="p">)</span>
<span class="c1"># ... INITIAL CONDITION</span>
<span class="n">solver</span><span class="o">.</span><span class="n">set_initial_condition</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">FT</span><span class="p">(</span><span class="n">u_exact</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">t</span><span class="p">)))</span>

<span class="c1"># -- RUN SOLVER</span>
<span class="n">solver</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="n">z_range</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">LD</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">n_skip</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># propagation range</span>
</pre></div>
</div>
<p>In the figure below, the top subfigure shows the time-domain propagation
dynamics of a fundamental soliton for the nonlinear Schrödinger equation in
the presence of fiber loss.
The subfigure at the bottom show the resulting decay of the energy in the
numerical experiment (solid line), along with the theoretical prediction
(dashed line).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">col</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.96</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_setColorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">refPos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;colorbar helper&quot;&quot;&quot;</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">refPos</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">refPos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">refPos</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">refPos</span><span class="o">.</span><span class="n">height</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">x0</span> <span class="o">+</span> <span class="mf">1.02</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="mf">0.025</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">])</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
        <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
        <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;out&quot;</span><span class="p">,</span>
        <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cbar</span>


<span class="c1"># -- TOP SUB-FIGURE: TIME-DOMAIN PROPAGATION CHARACTERISTICS</span>
<span class="n">It</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">utz</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">It</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">It</span><span class="p">)</span>

<span class="n">im1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolorfast</span><span class="p">(</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">It</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">col</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">cbar1</span> <span class="o">=</span> <span class="n">_setColorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_position</span><span class="p">())</span>
<span class="n">cbar1</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$|u|^2/{\rm</span><span class="si">{max}</span><span class="s2">}\left(|u|^2\right)$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$t~\mathrm{(fs)}$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">useOffset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># -- BOTTOM SUB-FIGURE: ENERGY DECAY</span>
<span class="n">Ez</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">solver</span><span class="o">.</span><span class="n">ua_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">ua_vals</span> <span class="o">/</span> <span class="n">Ez</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;simulation&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">Ez</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">Ez</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;theory&quot;</span>
<span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">useOffset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;sci&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Propagation distance $z~\mathrm{(\mu m)}$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$E(z)/E(0)$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="g NSE absorption constant" class="sphx-glr-single-img" src="../../_images/sphx_glr_g_NSE_absorption_constant_001.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.887 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-attenuation-g-nse-absorption-constant-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/2ed7ee829a4ae0b157229b7011c25613/g_NSE_absorption_constant.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">g_NSE_absorption_constant.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/39aeb22984f0f60b9ddfa18f9a7cfea6/g_NSE_absorption_constant.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">g_NSE_absorption_constant.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="ng_fiber_details_nlpm750.html" class="btn btn-neutral float-right" title="1.4.3. NLPM750 fiber model with loss" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="g_absorption_profile.html" class="btn btn-neutral float-left" title="1.4.1. Attenuation of a NLPM750 fiber" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, O. Melchert.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>