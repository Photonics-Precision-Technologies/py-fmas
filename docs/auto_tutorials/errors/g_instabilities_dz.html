

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>1.6.3. Numerical instabilities of the Nonlinear Schrödinger Equation &mdash; py-fmas 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Usage examples" href="../../auto_examples/index.html" />
    <link rel="prev" title="1.6.2. Propagation errors caused by a too narrow frequency window" href="g_error_3rdOrderSoliton.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> py-fmas
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">1. Extended user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#basic-examples">1.1. Basic examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#more-specific-examples">1.2. More specific examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#photon-number-conservation">1.3. Photon number conservation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#attenuation">1.4. Attenuation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#performance-tests">1.5. Performance tests</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#propagation-errors">1.6. Propagation errors</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="g_error_dealiasing.html">1.6.1. Implementing an anti-aliasing technique with a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="g_error_3rdOrderSoliton.html">1.6.2. Propagation errors caused by a too narrow frequency window</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.6.3. Numerical instabilities of the Nonlinear Schrödinger Equation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">2. Usage examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_manual/index.html">3. Reference manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citations.html">4. Citations</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">py-fmas</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">1. </span>Extended user guide</a> &raquo;</li>
        
      <li><span class="section-number">1.6.3. </span>Numerical instabilities of the Nonlinear Schrödinger Equation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/auto_tutorials/errors/g_instabilities_dz.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-errors-g-instabilities-dz-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="numerical-instabilities-of-the-nonlinear-schrodinger-equation">
<span id="sphx-glr-auto-tutorials-errors-g-instabilities-dz-py"></span><h1><span class="section-number">1.6.3. </span>Numerical instabilities of the Nonlinear Schrödinger Equation<a class="headerlink" href="#numerical-instabilities-of-the-nonlinear-schrodinger-equation" title="Permalink to this headline">¶</a></h1>
<p>This example demonstrates numerical instabilities that build up during
simulations of the standard nonlinear Schrödinger equation when the
<span class="math notranslate nohighlight">\(z\)</span>-increment used for propagtion is too small.</p>
<p>Here, the simple split-step Fourier method is used and the instabilities
develop from round-off errors during the propagation of a fundamental soliton.</p>
<p>The numerical instabilities of the nonlinear Schrödinger equation developing on
top of  plain wave solutions where first studied in Ref. <a class="reference internal" href="#wh1986" id="id1"><span>[WH1986]</span></a>.
An in-depth study of instabilities of the split-step Fourier method for the
simulation of the nonlinear Schrödinger equation, developing on a background
given by a soliton, is provided by Ref. <a class="reference internal" href="#l2012" id="id2"><span>[L2012]</span></a>.</p>
<p>We first import the functionality needed to perform the sequence of numerical
experiments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.fft</span> <span class="k">as</span> <span class="nn">nfft</span>
<span class="kn">from</span> <span class="nn">fmas.models</span> <span class="kn">import</span> <span class="n">ModelBaseClass</span>
<span class="kn">from</span> <span class="nn">fmas.config</span> <span class="kn">import</span> <span class="n">FTFREQ</span><span class="p">,</span> <span class="n">FT</span><span class="p">,</span> <span class="n">IFT</span><span class="p">,</span> <span class="n">C0</span>
<span class="kn">from</span> <span class="nn">fmas.solver</span> <span class="kn">import</span> <span class="n">SiSSM</span><span class="p">,</span> <span class="n">SySSM</span><span class="p">,</span> <span class="n">IFM_RK4IP</span><span class="p">,</span> <span class="n">LEM_SySSM</span><span class="p">,</span> <span class="n">CQE</span>
<span class="kn">from</span> <span class="nn">fmas.grid</span> <span class="kn">import</span> <span class="n">Grid</span>
</pre></div>
</div>
<p>Next, we implement a model for the nonlinear Schrödinger equation.  In
particular, we here consider the standard nonlinear Schrödinger equation,
given by</p>
<div class="math notranslate nohighlight">
\[\partial_z u = -i \frac{\beta_2}{2}\partial_t^2 u + i\gamma |u|^2 u,\]</div>
<p>wherein <span class="math notranslate nohighlight">\(u = u(z, t)\)</span> represents the slowly varying pulse envelope,
<span class="math notranslate nohighlight">\(\beta_2=-1\)</span> is the second order dispersion parameter, and
<span class="math notranslate nohighlight">\(\gamma=1\)</span> is the nonlinear parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NSE</span><span class="p">(</span><span class="n">ModelBaseClass</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">b2</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Lw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_w</span>

    <span class="k">def</span> <span class="nf">Nw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uw</span><span class="p">):</span>
        <span class="n">ut</span> <span class="o">=</span> <span class="n">IFT</span><span class="p">(</span><span class="n">uw</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="o">*</span><span class="n">FT</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ut</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">ut</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we initialize the computational domain and use a simple split-step
Fourier method to propagate a single fundamental soliton for ten soliton
periods.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- INITIALIZATION STAGE</span>
<span class="c1"># ... COMPUTATIONAL DOMAIN</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span> <span class="n">t_max</span> <span class="o">=</span> <span class="mf">30.</span><span class="p">,</span> <span class="n">t_num</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">10</span><span class="p">)</span>
<span class="n">t</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">w</span>
<span class="c1"># ... NSE MODEL</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NSE</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b2</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="c1"># ... INITIAL CONDITION</span>
<span class="n">u_0t</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p>In a first numerical experiment, the stepsize is intentionally kept very
large in order to allow the numerical istabilities to build up.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">SySSM</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Lw</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Nw</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">set_initial_condition</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">FT</span><span class="p">(</span><span class="n">u_0t</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="n">z_range</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">511</span><span class="p">,</span> <span class="n">n_skip</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">z</span><span class="p">,</span> <span class="n">utz</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">z_</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">utz</span>
</pre></div>
</div>
<p>In this case, instabilities are expected to build up since the
<span class="math notranslate nohighlight">\(z\)</span>-increment <span class="math notranslate nohighlight">\(\Delta z\)</span>, used by the propagation algorithm,
exceeds the threshold increment <span class="math notranslate nohighlight">\(\Delta
z_{\mathrm{T}}=2\pi/\mathrm{max}(\omega)\)</span> (both increments are displayed
below).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- MAXIMUM FREQUENCY SUPPORTED ON COMPUTATIONAL GRID</span>
<span class="n">w_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># -- THRESHOLD INCREMENT</span>
<span class="n">dz_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="n">w_max</span><span class="o">**</span><span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Increment dz =&quot;</span><span class="p">,</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Threshold increment dz_T =&quot;</span><span class="p">,</span> <span class="n">dz_T</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Increment dz = 0.061479308289428436
Threshold increment dz_T = 0.0021856605344040803
</pre></div>
</div>
<p>In a second numerical experiment, the stepsize is set small enough to shift
the resonance outside the computational domain.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">SySSM</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Lw</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Nw</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">set_initial_condition</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">FT</span><span class="p">(</span><span class="n">u_0t</span><span class="p">))</span>
<span class="n">solver</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="n">z_range</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">15000</span><span class="p">,</span> <span class="n">n_skip</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">z2</span><span class="p">,</span> <span class="n">utz2</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">z_</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">utz</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Increment dz =&quot;</span><span class="p">,</span> <span class="n">z2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">z2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Threshold increment dz_T =&quot;</span><span class="p">,</span> <span class="n">dz_T</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Increment dz = 0.0020943951023931952
Threshold increment dz_T = 0.0021856605344040803
</pre></div>
</div>
<p>Next, we prepare a figure that shows the results of the above to experiments.
The left subfigure shows the results of the first simulation run in which the
numerical instabilities and their predicted locations are shown.
The right subfigure shows the results of second simulation run in which the
<span class="math notranslate nohighlight">\(z\)</span>-increment was small enough to shift the instabilities outside the
computational domain.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">col</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1"># -- EXAMPLE WITH INSTABILITIES</span>

<span class="n">dz</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">w_I</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">2.</span><span class="o">/</span><span class="n">dz</span><span class="p">)</span>

<span class="n">shift</span><span class="o">=</span><span class="n">nfft</span><span class="o">.</span><span class="n">fftshift</span>
<span class="n">Iw_ini</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FT</span><span class="p">(</span><span class="n">utz</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Iw_fin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FT</span><span class="p">(</span><span class="n">utz</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shift</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">shift</span><span class="p">(</span><span class="n">Iw_ini</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Iw_ini</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$z=0$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shift</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">shift</span><span class="p">(</span><span class="n">Iw_fin</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Iw_ini</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$z=10\pi$&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">w_I</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="n">w_I</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

<span class="n">dw_lim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">35</span><span class="p">,</span><span class="mi">35</span><span class="p">)</span>
<span class="n">dw_ticks</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">dw_lim</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">dw_ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Detuning $\omega$&quot;</span><span class="p">)</span>

<span class="n">y_lim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-35</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y_ticks</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-30</span><span class="p">,</span><span class="mf">1e-20</span><span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Spectral intensity $I_\omega(z)/\mathrm</span><span class="si">{max}</span><span class="s2">(I_\omega(z=0)}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Numerical instabilities build up&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># -- EXAMPLE WITHOUT INSTABILITIES</span>

<span class="n">Iw_ini</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FT</span><span class="p">(</span><span class="n">utz2</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Iw_fin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FT</span><span class="p">(</span><span class="n">utz2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shift</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">shift</span><span class="p">(</span><span class="n">Iw_ini</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Iw_ini</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$z=0$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shift</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">shift</span><span class="p">(</span><span class="n">Iw_fin</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Iw_ini</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$z=10\pi$&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">dw_lim</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">dw_ticks</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Detuning $\omega$&quot;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_lim</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;No numerical instabilities&quot;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Numerical instabilities build up, No numerical instabilities" class="sphx-glr-single-img" src="../../_images/sphx_glr_g_instabilities_dz_001.png" />
<p><strong>References:</strong></p>
<dl class="citation">
<dt class="label" id="wh1986"><span class="brackets"><a class="fn-backref" href="#id1">WH1986</a></span></dt>
<dd><p>J.A.C. Weideman, B.M. Herbst, Split-step methods for the solution
of the nonlinear Schrödinger equation, SIAM J. Numer. Anal., 23
(1986) 485, <a class="reference external" href="http://www.jstor.org/stable/2157521">http://www.jstor.org/stable/2157521</a>.</p>
</dd>
<dt class="label" id="l2012"><span class="brackets"><a class="fn-backref" href="#id2">L2012</a></span></dt>
<dd><p>T.I. Lakoba, Instability Analysis of the Split-Step Fourier Method
on the Background of a Soliton of the Nonlinear Schrödinger
Equation, Numerical Methods for Partial Differential Equations 28
(2012) 641, <a class="reference external" href="https://doi.org/10.1002/num.20649">https://doi.org/10.1002/num.20649</a></p>
</dd>
</dl>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  4.361 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-errors-g-instabilities-dz-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9277a0be80c16708f62b9223977e07c0/g_instabilities_dz.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">g_instabilities_dz.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ee011c6a01f7095b00e749525322f76b/g_instabilities_dz.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">g_instabilities_dz.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../../auto_examples/index.html" class="btn btn-neutral float-right" title="2. Usage examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="g_error_3rdOrderSoliton.html" class="btn btn-neutral float-left" title="1.6.2. Propagation errors caused by a too narrow frequency window" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, O. Melchert.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>